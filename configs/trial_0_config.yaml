dataset:
  handle_missing_values: mask
  map_resolution: 1.0
  normalize_features: true
  scene_extent: 512
  test_on_eval: true
  test_zarr_path: /home/ubuntu/projects/CellularPositioningResearch/data/processed/sionna_dataset_eval/dataset_eval.zarr
  train_zarr_paths:
  - /home/ubuntu/projects/CellularPositioningResearch/data/processed/sionna_dataset/dataset_20260101_184259.zarr
infrastructure:
  accelerator: auto
  checkpoint:
    dirpath: /home/ubuntu/projects/CellularPositioningResearch/checkpoints/multi_city_optuna_20260101_184159
    mode: min
    monitor: val_median_error
    save_top_k: 3
  devices: 1
  early_stopping:
    mode: min
    monitor: val_median_error
    patience: 10
  logging:
    log_every_n_steps: 10
    project: ue-localization
    use_comet: true
    use_wandb: false
  num_workers: 8
  precision: 32-true
model:
  coarse_head:
    d_input: 128
    dropout: 0.1
    grid_size: 32
  fine_head:
    d_hidden: 256
    d_input: 128
    dropout: 0.1
    top_k: 5
  fusion:
    d_fusion: 128
    dropout: 0.21071252468272683
    nhead: 8
  map_encoder:
    d_model: 256
    dropout: 0.1400474003032033
    img_size: 256
    in_channels: 10
    nhead: 8
    num_layers: 4
    osm_map_channels: 5
    patch_size: 32
    radio_map_channels: 5
    use_e2_equivariant: true
  name: MapConditionedTransformer
  radio_encoder:
    d_model: 128
    dropout: 0.17184798486918024
    embedding:
      beam_id_embed_dim: 32
      cell_id_embed_dim: 64
      feature_dim: 256
      time_embed_dim: 64
    mac_features_dim: 6
    max_seq_len: 20
    nhead: 2
    num_beams: 64
    num_cells: 3
    num_layers: 2
    phy_features_dim: 8
    rt_features_dim: 16
    type: SetTransformer
    use_feature_masking: true
    use_token_masking: true
physics_loss:
  feature_weights:
    aoa: 0.1
    bler: 0.2
    path_gain: 1.0
    sinr: 0.5
    snr: 0.5
    throughput: 0.2
    toa: 0.1
  lambda_phys: 0.1
  loss_type: mse
  normalize_features: true
training:
  batch_size: 8
  gradient_clip: 1.0
  gradient_clip_val: 1.0
  learning_rate: 0.00013583861930140296
  loss:
    augmentation:
      feature_dropout: 0.05
      feature_noise: 0.01
      random_flip: true
      random_rotation: true
      scale_range:
      - 0.9
      - 1.1
      temporal_dropout: 0.0
    coarse_weight: 1.0
    fine_weight: 1.0
    use_physics_loss: false
  num_epochs: 10
  optimizer: adamw
  scheduler: cosine_with_warmup
  warmup_steps: 500
  weight_decay: 0.0037025996504164104
